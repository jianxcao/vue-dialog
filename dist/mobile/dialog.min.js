!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("vue")):"function"==typeof define&&define.amd?define(["vue"],e):t.dialog=e(t.Vue)}(this,function(t){"use strict";function e(t){return r.call(t)===a}function i(t,e){e=e||0;for(var i=t.length-e,n=new Array(i);i--;)n[i]=t[i+e];return n}function n(t,e){return l.call(t,e)}function o(t){var e=window.getComputedStyle(t),i=e[g+"Delay"].split(", "),n=e[g+"Duration"].split(", "),o=function(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max.apply(null,e.map(function(e,i){return s(e)+s(t[i])}))}(i,n),r=0,a=0;return o>0&&(r=o,a=n.length),{timeout:r,propCount:a}}function s(t){return 1e3*Number(t.slice(0,-1))}t="default"in t?t.default:t,"function"!=typeof Object.assign&&(Object.assign=function(t){var e=arguments;if(null==t)throw new TypeError("Cannot convert undefined or null to object");t=Object(t);for(var i=1;i<arguments.length;i++){var n=e[i];if(null!=n)for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}),window.requestAnimationFrame||(window.requestAnimationFrame=function(t){setTimeout(t,17)}),Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)});var r=Object.prototype.toString,a="[object Object]",l=Object.prototype.hasOwnProperty,c="undefined"!=typeof window&&window.navigator.userAgent.toLowerCase(),d=c&&/msie|trident/.test(c),h=(c&&c.indexOf("msie 9.0"),c&&c.indexOf("edge/")>0),u=(c&&c.indexOf("android"),c&&/iphone|ipad|ipod|ios/.test(c)),f=(c&&/chrome\/\d+/.test(c),function(t){return!(!t||"object"!=typeof t)&&(n(t,"tag")&&n(t,"componentOptions"))}),p=/^\s*<(\w+)>.*<\/(\w+)>\s*$/,m=/^esDialog\d+$/,g="transition",v="transitionend";void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(g="WebkitTransition",v="webkitTransitionEnd"),function(){Array.prototype.CSSClassIndexOf=Array.prototype.indexOf||function(t){for(var e=this.length,i=0;i<e;i++)if(this[i]===t)return i;return-1};var t="classList"in document.createElement("a"),e=Element.prototype;t?(e.hasClass||(e.hasClass=function(t){Array.prototype.slice.call(this.classList);t=t.split(" ");for(var e=0;e<t.length;e++)if(!this.classList.contains(t[e]))return!1;return!0}),e.addClass||(e.addClass=function(t){t=t.split(" ");for(var e=0;e<t.length;e++)this.hasClass(t[e])||this.classList.add(t[e]);return this}),e.removeClass||(e.removeClass=function(t){this.className.split(" ");t=t.split(" ");for(var e=0;e<t.length;e++)this.hasClass(t[e])&&this.classList.remove(t[e]);return this}),e.toggleClass||(e.toggleClass=function(t){t=t.split(" ");for(var e=0;e<t.length;e++)this.classList.toggle(t[e]);return this})):(e.hasClass||(e.hasClass=function(t){var e=this.className.split(" ");t=t.split(" ");for(var i=0;i<t.length;i++)if(-1===e.CSSClassIndexOf(t[i]))return!1;return!0}),e.addClass||(e.addClass=function(t){t=t.split(" ");for(var e=0;e<t.length;e++)this.hasClass(t[e])||(this.className=""!==this.className?this.className+" "+t[e]:t[e]);return this}),e.removeClass||(e.removeClass=function(t){var e=this.className.split(" ");t=t.split(" ");for(var i=0;i<t.length;i++)this.hasClass(t[i])&&e.splice(e.CSSClassIndexOf(t[i]),1);return this.className=e.join(" "),this}),e.toggleClass||(e.toggleClass=function(t){t=t.split(" ");for(var e=0;e<t.length;e++)this.hasClass(t[e])?this.removeClass(t[e]):this.addClass(t[e]);return this}));var i=NodeList.prototype;i.hasClass||(i.hasClass=function(t,e){void 0===e&&(e=!0);for(var i=this.length-1;i>=0;--i){var n=this[i].hasClass(t);if(e&&!n)return!1;if(!e&&n)return!0}return!0}),i.addClass||(i.addClass=function(t){for(var e=0;e<this.length;++e)this[e].addClass(t)}),i.removeClass||(i.removeClass=function(t){for(var e=0;e<this.length;++e)this[e].removeClass(t)}),i.toggleClass||(i.toggleClass=function(t){for(var e=0;e<this.length;++e)this[e].toggleClass(t)})}();var y={startZIndex:1e3},b=function(t){this.opt=Object.assign({},t,y),this._zIndex=this.opt.startZIndex,this._instance=[],this.add=this.add.bind(this),this.del=this.del.bind(this),this.indexOf=this.indexOf.bind(this),this.setTopInstance=this.setTopInstance.bind(this),this.getTopInstance=this.getTopInstance.bind(this),this.getAllInstance=this.getAllInstance.bind(this),this.nextZIndex=this.nextZIndex.bind(this)};b.prototype.add=function(e){return e&&e.id&&e instanceof t&&-1===this.indexOf(e)&&this._instance.push(e),e},b.prototype.size=function(){return this._instance.length},b.prototype.indexOf=function(e){var i=typeof e;if("string"===i&&m.test(e)||"object"===i&&e instanceof t)for(var n=0,o=this._instance.length;n<o;n++){var s=this._instance[n];if(s===e||s.id===e)return n}return-1},b.prototype.del=function(t){var e=this.indexOf(t);return e>-1&&(this._instance.splice(e,1),!0)},b.prototype.isAllMounted=function(){return this._instance.every(function(t){return t&&t._isMounted})},b.prototype.setTopInstance=function(t){var e=this.indexOf(t);if(e>-1&&e!==this._instance.length-1&&this.isAllMounted()){var i=this._instance.splice(e,1);return this._instance.push(i[0]),i}},b.prototype.getTopInstance=function(){if(this._instance.length)return this._instance[this._instance.length-1]},b.prototype.getInstance=function(t){var e=this.indexOf(t);if(e>-1)return this._instance[e]},b.prototype.getAllInstance=function(){return(this._instance||[]).slice(0)},b.prototype.nextZIndex=function(){return this._zIndex++};var w={name:"overlay",props:{lock:{type:Boolean,default:!1},position:{type:String,default:"fixed"},resize:{type:Boolean,default:!1},ani:{type:Boolean,default:!0},fullScreen:{type:Boolean,default:!1},lockIosHeight:{type:Boolean,default:!1}},data:function(){return{bodyContainer:!1}},watch:{resize:function(t,e){t?window.addEventListener("resize",this.bodyResize):window.removeEventListener("resize",this.bodyResize)},position:function(){this.update()},lock:function(){this.update()},bodyContainer:function(){this.update()}},mounted:function(){var t,e=this.$el;if(this.fullScreen)t=document.body;else for(t=e.parentNode;t&&t!==document.body&&1!==t.nodeType;)t=t.parentNode;t===document.body&&(this.bodyContainer=!0);var i=t.style;this.bodyContainer&&(this._holderDiv=document.createElement("div"),document.body.insertBefore(this._holderDiv,document.body.firstChild),this._originScrollTop=document.body.scrollTop),this._originOverflow=i.overflow,this._originPos=i.position,this._originHeight=i.height,this._lockParentEle=t,this.resize&&window.addEventListener("resize",this.bodyResize),this.update()},destroyed:function(){if(this._lockParentEle){var t=this._lockParentEle.style;t.overflow=this._originOverflow,t.position=this._originPos,this._holderDiv&&document.body.removeChild(this._holderDiv),this.bodyContainer&&this.lock&&(document.documentElement.style.overflow=this._originOverflow,u&&(t.height=this._originHeight,document.documentElement.style.height=this._originHeight,document.body.scrollTop=this._originScrollTop,document.body.removeClass("body-overflow"))),this._lockParentEle=null,this._originOverflow=null,this._originPos=null,this._originHeight=null,this._originScrollTop=null,this.resize&&window.removeEventListener("resize",this.bodyResize)}},render:function(t){var e=t("div",{class:"layout mask",directives:[]},[this.$slots.default]);return this.ani?t("transition",{props:{name:"overlay-animate"}},[e]):e},methods:{maskSize:function(t,e){t=+t,e=+e;var i=this.$el;if(!t>=0&&!e>=0&&this._lockParentEle)if(this.bodyContainer)this.lockIosHeight?(e=Math.max(window.innerHeight,document.body.clientHeight),t=Math.max(window.innerWidth,document.body.clientWidth)):(e=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight,window.innerHeight),t=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth,window.innerWidth));else{var n=this._lockParentEle.getBoundingClientRect();e=n.height,t=n.width}return t>=0&&(i.style.width=t+"px"),e>=0&&(i.style.height=e+"px"),this.bodyContainer&&this.lockIosHeight&&Object.assign(i.style,{top:document.body.scrollTop+"px",left:document.body.scrollLeft+"px"}),this},update:function(){var t=this.$el,e=this.position,i=this._lockParentEle;if(!i)return this;var n=i.style;if(this.lock){if(n.overflow="hidden",this.bodyContainer&&(document.documentElement.style.overflow="hidden",u&&this.lock&&this.lockIosHeight)){var o=window.innerHeight+"px";document.documentElement.style.height=o,document.body.style.height=o,document.body.addClass("body-overflow"),document.body.style.webkitOverflowScrolling="auto";var s="-"+this._originScrollTop+"px";document.body.scrollTop=0,Object.assign(this._holderDiv.style,{marginTop:s})}}else n.overflow=this._originOverflow,this.bodyContainer&&(document.documentElement.style.overflow=this._originOverflow,u&&this.lock&&this.lockIosHeight&&(this._holderDiv.style="",document.body.style.height=this._originHeight,document.documentElement.style.height=this._originHeight,document.body.removeClass("body-overflow")));if(!this.bodyContainer){"static"===window.getComputedStyle(i).position&&(n.position="relative")}return t.style.position=e,"absolute"===e&&this.maskSize(),this.$emit("update"),this},bodyResize:function(){var t=this;this._resizeTime&&window.clearTimeout(this._resizeTime),this._resizeTime=window.setTimeout(function(){t.maskSize()},350)}}},_=(t.extend({data:function(){return{closed:!0}},render:function(t){var e=[];return e.push({name:"show",rawName:"v-show",value:!this.closed,expression:"!closed"}),t("overlay",{directives:e,props:{lock:this.lock,position:this.position,resize:this.resize,ani:this.ani}})},methods:{destroy:function(){this.closed=!0,this.ani&&!this.$isServer?this.$el.addEventListener(v,this.doDestroy):this.doDestroy()},doDestroy:function(){this.$el&&(this.$destroy(),this.$el.parentNode.removeChild(this.$el))}},components:{overlay:w}}),new b),C=function(t){return function(){return t++}}(0),x=/^\*.+/,$=/^\d+$/,k={btnCssMap:{def:"es-dialog-btn","*":"es-dialog-focus-btn"},getBtnRetId:function(t,e){return e>1?t:1}},O={l:/l/i,t:/t/i,r:/r/i,b:/b/i,c:/c/i},T=function(){var t=/(^[lcr][tcb]$)|(^[tcb][lcr]$)|(^[tcblr]$)/,i=["left","top","bottom","right","marginTop","marginLeft"];return function(n){var o=typeof n;return"function"===o||(e(n)?i.some(function(t){return void 0!==t&&null!==t}):Array.isArray(n)?2===n.length&&void 0!==n[0]&&void 0!==n[1]:"number"===o?n>=0&&n<=8:"string"===o&&t.test(n))}}(),I=function(e,i,n){if(f(e))return e;var o=n.id+"-"+i,s=typeof e;"string"!==s&&"number"!==s||(e=function(t){return"string"==typeof t&&p.test(t)&&RegExp.$1===RegExp.$2}(e)?{name:o,template:e+""}:{name:o,template:["<div>",e,"</div>"].join("")});var r,a={beforeCreate:function(){n["$"+i]=this},data:function(){return t={dialogData:n[i+"Data"]},t[i+"Data"]=n[i+"Data"],t;var t}};return!function(t){return"function"==typeof t&&"function"==typeof t.super&&t.directive&&t.component}(e)?e._Ctor?r=t.extend(e).extend({mixins:[a]}):(r=t.extend(Object.assign({},e))).mixin(a):(r=e.extend({mixins:[a]})).options.name||(r.options.name=o),r},j=function(t,e,i,n){return void 0===e&&(e={}),f(t)?t:t?n(t,{ref:["$"+i]}):n("")},E=function(){if(!this._isBeingDestroyed&&!this._isDestroyed&&this._isMounted){var t=this.$refs.dialog;if($.test(this.width)){var e=parseInt(this.width,10);0===e?t.style.width="auto":e>0&&(t.style.width=e+"px")}else t.style.width=this.width}},A=function(){if(!this._isBeingDestroyed&&!this._isDestroyed&&this._isMounted){var t=this.$refs.main;if($.test(this.height)){var e=parseInt(this.height,10);0===e?t.style.height="auto":e>0&&(t.style.height=e+"px")}else t.style.height=this.height}},D=function(){if(this._isBeingDestroyed||this._isDestroyed||!this._isMounted)return{};var t=this.position,i=this.$refs.dialog,n={};if("function"==typeof t)return n=t.call(this),e(n)&&(n=Object.assign({left:"",top:"",bottom:"",right:"",marginTop:"",marginLeft:""},n),Object.assign(i.style,n)),n;var o=i.getBoundingClientRect();if(0===o.width)return{};var s=o.width,r=o.height,a="fixed"===this.dialogPos,l=window,c=[Math.max(document.body.scrollLeft,document.documentElement.scrollLeft),Math.max(document.documentElement.scrollTop,document.body.scrollTop)],d=[0,0,l.innerWidth,l.innerHeight],h={left:a?{left:0}:{left:d[0]+c[0]+"px"},center:a?{left:"50%",marginLeft:"-"+s/2+"px"}:{left:Math.floor((d[2]+d[0]-s)/2)+c[0]+"px"},right:a?{right:0}:{left:d[2]-s+c[0]+"px"}},u={top:a?{top:0}:{top:d[1]+c[1]+"px"},center:function(){var t=Math.floor((d[3]+d[1]-r)/2)+c[1],e=t<0?Math.abs(t):0;return a?{top:"50%",marginTop:"-"+(r/2-e)+"px"}:{top:e?0:t+"px"}}(),bottom:a?{bottom:0}:{top:Math.max(0,d[3]-r+c[1])+"px"}};switch(t.constructor){case String:var f=O;t=1===t.length?t+"c":t,t=f.t.test(t)?f.l.test(t)?1:f.r.test(t)?3:2:f.b.test(t)?f.l.test(t)?7:f.r.test(t)?5:6:f.c.test(t)?f.l.test(t)?8:f.r.test(t)?4:0:0;case Number:if(t<0||t>8)break;var p=[[h.center,u.center],[h.left,u.top],[h.center,u.top],[h.right,u.top],[h.right,u.center],[h.right,u.bottom],[h.center,u.bottom],[h.left,u.bottom],[h.left,u.center]];n=Object.assign(n,p[t][0],p[t][1]);break;case Array:n.left=0===t[0]?0:t[0]||"",n.top=0===t[1]?0:t[1]||"";break;default:n=Object.assign({},t||{})}return["left","right","top","bottom"].forEach(function(t,e){var i=n[t];t in n&&(i?["auto","c","center"].indexOf(i)>=0:0!==i)&&delete n[t]}),"left"in n||"right"in n||Object.assign(n,h.center),"top"in n||"bottom"in n||Object.assign(n,u.center),n=Object.assign({left:"",top:"",bottom:"",right:"",marginTop:"",marginLeft:""},n),Object.assign(i.style,n),n},M=function(t,e){t&&t.nodeType&&(e?Object.assign(t.style,{left:"-9999px",top:"-9999px",visibility:"hidden"}):Object.assign(t.style,{visibility:"visible"}))},S=function(t,e){var i=o(t),n=null;if(0===i.timeout)e();else{var s=function(){n&&window.clearTimeout(n),t.removeEventListener(v,s),e()};n=window.setTimeout(s,i.timeout),t.addEventListener(v,s)}},P=function(t,e){var i=t.$refs.dialog,n=t.$el,o=window.getComputedStyle(n);if(!t._animate)if(t._animate=!0,"none"!==o.display){var s=t.animate;if(0===s||d)return t.hidden=e,M(t.$el,e),t._animate=!1,void t.$emit(e?"hide":"show");var r="es-dialog-ani-"+s,a="es-ani-"+(e?"hide":"show"),l=function(){t._animate=!1,t.animateCss=[],e&&M(t.$el,e),t.$emit(e?"hide":"show")};t.animateCss=[e?a:r],e?window.setTimeout(function(){t.animateCss.push(r),S(i,l)},48):(M(t.$el,e),window.setTimeout(function(){t.animateCss.push(a),window.setTimeout(function(){t.animateCss=[a],S(i,l)},16)},48))}else t._animate=!1},L=function(){var t=!0;_.getAllInstance().forEach(function(e){var i=+e.layout;-1!==i&&0!==i&&e.$mask&&!e.hidden&&(t?(e.$mask.$el.style.opacity="",t=!1):e.$mask.$el.style.opacity="0")})},z=function(){var t=this.$el.parentNode;t&&(this.$destroy(),t.removeChild(this.$el))},B=function(t){if(null!==t&&void 0!==t&&(this._closeRet=t),this._closing)return this;if(this._$$emit("beforeClose",this._closeRet).some(function(t){return!1===t}))return this;this._closing=!0,this.hidden?(z.call(this),this._closing=!1):(this.$once("hide",function(){z.call(this),this._closing=!1}),this.hide())},N={props:{name:"dialog",titleData:{type:[Object],default:function(){return{}}},contentData:{type:[Object],default:function(){return{}}},button:{type:[Array,null],default:function(){return["*确定"]}},width:{type:[String,Number],default:0},height:{type:[String,Number],default:0},position:{type:[String,Object,Number,Array,Function],default:"c",validator:T},dragable:{type:[Number,Boolean],default:!0},layout:{type:[Number,Boolean],default:1},animate:{type:Number,default:0},stylesheet:{type:[Array,Object],default:function(){return{}}},css:{type:[String,Object,Array],default:""},timeout:{type:Number,default:0},lock:{type:Boolean,default:!1},lockIosHeight:{type:Boolean,default:!1}},data:function(){return{maskIndex:_.nextZIndex(),dialogIndex:_.nextZIndex(),animateCss:[],hidden:!0,dialogPos:"fixed",maskPos:"fixed"}},beforeCreate:function(){var t=this;Object.defineProperty(this,"id",{value:"esDialog"+C(),enumerable:!0}),_.add(this),Object.defineProperty(this,"dialogManager",{value:_,enumerable:!0}),Object.defineProperty(this,"title",{value:function(e){if(void 0===e)return t._title;t._title=e}}),Object.defineProperty(this,"content",{value:function(e){if(void 0===e)return t._content;t._content=e}}),this._$$emit=function(t){var e=this._events[t],n=[];if(e){e=e.length>1?i(e):e;for(var o=i(arguments,1),s=0,r=e.length;s<r;s++)n.push(e[s].apply(this,o))}return n}},created:function(){var t=this,e="",i="";Object.defineProperty(this,"_title",{enumerable:!1,configurable:!1,get:function(){return e},set:function(i){void 0!==i&&(e=i,t.$nextTick(function(){t._titleComponent=null!==e?I(e,"title",t):"",t.$forceUpdate(),t.setPosition(!0),t.$emit("changeTitle")}))}}),Object.defineProperty(this,"_content",{enumerable:!1,configurable:!1,get:function(){return i},set:function(e){void 0!==e&&(i=e,t._contentComponent=I(i||"","content",t),t.$forceUpdate(),t.setPosition(!0),t.$emit("changeContent"))}})},mounted:function(){var t=this;this.$refs.$mask&&(this.$mask=this.$refs.$mask),this.focusBtn(),E.call(this),A.call(this),D.call(this),window.setTimeout(function(){t.hidden=!1})},updated:function(){this.$refs.$mask?this.$mask=this.$refs.$mask:delete this.$mask},beforeDestroy:function(){this.$emit("close",this._closeRet)},destroyed:function(){_.del(this),this.$emit("closed",this._closeRet)},render:function(t){var i=this.maskIndex,n=this.dialogIndex,o=function(t){var i=[];t&&i.push(t);var n=this.stylesheet;return e(n)||"string"==typeof n?i.push(n):Array.isArray(n)&&(i=i.concat(n)),i}.call(this,{zIndex:n,position:this.dialogPos}),s=function(){for(var t=[],i=arguments.length;i--;)t[i]=arguments[i];var n=this.css,o=[];return"string"==typeof n&&(o=n.split(" ").map(function(t){return t.trim()})),Array.isArray(n)?o=n.slice(0):e(n)&&(o=[n]),o.concat(t)}.call(this,"es-dialog","m-dialog");s=s.concat(this.animateCss);var r=[];r.push(function(t){var e=this.title();if(void 0===e||null===e)return t("");var i=[this._t("title")];return i.push(j(this._titleComponent,this.titleData,"title",t)),t("div",{class:"es-dialog-head m-dialog-head",ref:"title"},[t("h1",i),t("a",{class:"es-dialog-close m-dialog-close",attrs:{hidefocus:"true","data-action":"close"}},[t("em",[""])])])}.call(this,t)),r.push(function(t){return t("div",{class:"es-dialog-body m-dialog-body"},[t("div",{class:"es-dialog-main m-dialog-main",ref:"main"},[j(this._contentComponent,this.contentData,"content",t)])])}.call(this,t)),this.button&&this.button.length&&r.push(function(t){var e=this.button,i=e.length,n=e.map(function(e,n){var o=x.test(e),s={};return s[k.btnCssMap.def]=!0,s[k.btnCssMap["*"]]=o,t("a",{class:s,attrs:{"data-action":"btn","data-ret":k.getBtnRetId(n,i),href:"javascript:void(0);"}},[t("span",[o?e.slice(1):e])])});return t("div",{class:"m-dialog-footer es-dialog-footer",ref:"footer"},n)}.call(this,t));var a=[t("div",{class:s,style:o,ref:"dialog",on:{click:this.dialogClick}},r)],l=+this.layout;if(0!==l){var c=_.getAllInstance().filter(function(t){return 0!==t.layout&&!1!==t.layout&&-1!==t.layout&&!t.hidden})||[];a.unshift(t(w,{style:{zIndex:i,opacity:c[0]?c[0]!==this._self?2===l?"":"0":-1===l?"0":"":""},ref:"$mask",props:{ani:!1,lockIosHeight:this.lockIosHeight,position:this.maskPos,resize:!("fixed"===this.maskPos),fullScreen:!0,lock:this.lock}}))}return t("div",{class:"es-dialog-wrap",domProps:{id:this.id}},a)},watch:{position:function(t,e){T(t)?D.call(this):this.position=e},contentData:function(t){this._contentComponent=I(this.content()||"","content",this)},titleData:function(){this._titleComponent=I(this.title()||"","title",this)},dialogPos:function(t){D.call(this)},width:function(t){E.call(this),D.call(this)},height:function(t){A.call(this),D.call(this)},hidden:function(t,e){this.$refs.dialog?(L(),P(this,t)):this.$nextTick(function(){L(),P(this,t)})},timeout:{handler:function(t){var e=this;t&&(this._closeTimer&&window.clearTimeout(this._closeTimer),this._closeTimer=window.setTimeout(function(){e.close()},t))},immediate:!0}},methods:{setTop:function(){_.setTopInstance(this)&&(this.maskIndex=_.nextZIndex(),this.dialogIndex=_.nextZIndex(),this.focusBtn(),L())},dialogClick:function(t){var e=t.target,i=this.$refs.dialog;if(i)for(;e;){if(1===e.nodeType){var n=e.getAttribute("data-action");if("btn"===n||"close"===n){var o=e.getAttribute("data-ret")||null;/^[-.\d]+$/.test(o)&&(o=+o);if(this._$$emit("btnClick",o).some(function(t){return!1===t}))return;return this._closeRet=o,void this.close()}}if(e===i)break;e=e.parentNode}this.setTop()},focusBtn:function(){var t=this.$refs.dialog.querySelector("."+k.btnCssMap["*"]);t&&t.focus()},setPosition:function(t){var e=typeof t;!0===t?D.call(this):"function"===e?this.position=t.call(this)||{}:"string"!==e&&"number"!==e&&"object"!==e||(this.position=t)},show:function(){this.hidden=!1},hide:function(){this.hidden=!0},close:function(t){if(!(this._animate||this._isBeingDestroyed||this._isDestroyed))return this._isMounted?B.call(this,t):this.$once("show",function(){this.$nextTick(function(){B.call(this,t)})}),this},destroy:function(t){return this.close(t)},toString:function(){return this.id}}};!function(t){if(document.addEventListener)if(~["complete","loaded","interactive"].indexOf(document.readyState))setTimeout(t,0);else{var e=function(){document.removeEventListener("DOMContentLoaded",e,!1),t()};document.addEventListener("DOMContentLoaded",e,!1)}}(function(){document.body.addEventListener("keydown",function(t){if(27===t.keyCode){var e=_.getTopInstance();if(e&&e.$refs.dialog){var i=e.$refs.dialog.querySelector(".es-dialog-close");if(!i)return;var n=i.getBoundingClientRect();n.height&&n.width&&e.close()}}})}),Object.assign(N.methods,function(){var t=/(?:hook:)?([a-z])/;return["show","hide","btnClick","beforeClose","close","closed","hook:beforeMount","hook:mounted","hook:beforeUpdate","hook:updated"].reduce(function(e,i){return e[i.replace(t,function(t,e){return e?"on"+e.toUpperCase():"on"})]=function(t){return"function"==typeof t&&this.$on(i,t),this},e},{})}());var H,R=function(){var t=_.getAllInstance();t&&t.reverse().forEach(function(t){t.close()})},Z=function(t){void 0===t&&(t={}),t&&(t.getBtnRetId&&"function"==typeof t.getBtnRetId&&(k.getBtnRetId=t.getBtnRetId),t.btnCssMap&&(t.btnCssMap.def&&(k.btnCssMap.def=t.btnCssMap.def),t.btnCssMap["*"]&&(k.btnCssMap["*"]=t.btnCssMap["*"])))},q=!1,W=function(){var t=this.$el.querySelectorAll("input,textarea");if(t&&t.length){this.maskPos="absolute",this.dialogPos="absolute",this.lock=!0,this.$nextTick(function(){this.setPosition(!0)});for(var e=t.length,i=0;i<e;i++){var n=t[i];n.removeEventListener("focus",this.__evt_focus),n.addEventListener("focus",this.__evt_focus),n.removeEventListener("blur",this.__evt_blur),n.addEventListener("blur",this.__evt_blur)}}},U=function(e){function i(i,n){if(!i)return R();if(i instanceof e)return i.close();var o=typeof i;if("string"===o)if(m.test(i)){var s=_.getInstance(i);if(s){var r="string"==typeof n?n:void 0;return s.close(r)}}else i={content:i};else"object"===o&&(f(i)||i.template||i.render||i.super===t)&&(i={content:i});if("object"==typeof i){i.method||(i.method="prepend"),i.stylesheet=["style","cssObj"].reduce(function(t,e){var n=i[e];return n&&(Array.isArray(n.concat)?t=t.concat(n):t.push(n),delete i[e]),t},[]),i.css=["class","className","classname","css"].reduce(function(t,e){var n=i[e];return n&&(Array.isArray(n.concat)?t=t.concat(n):t.push(n),delete i[e]),t},[]);var a=document.createElement("div");"prepend"===i.method?document.body.insertBefore(a,document.body.firstChild):document.body.appendChild(a),delete i.method;var l=new e({created:function(){this._title=i.title,this._content=i.content||""},propsData:i});return n&&"function"==typeof n&&l.$once("closed",n),window.setTimeout(function(){l.$mount(a)},0),l}}i.alert=function(t,e,i){return n(t,e,i,0,"es-dialog-alert")},i.confirm=function(t,e,i){return n(t,e,i,["取消","*确定"],"es-dialog-confirm")},i.error=function(t,e,i){return n(t,e,i,0,"es-dialog-error")},i.toast=function(t,e,n){return"function"==typeof e&&(n=e,e=0),i({title:null,css:"es-dialog-toast",content:t,button:[],layout:-1,position:{bottom:"30%"},timeout:e||2500,animate:6},n)};var n=function(t,e,n,o,s){return"function"==typeof e&&(n=e,e=0),i({title:null,css:s||"es-dialog-info",content:t,dragable:2,button:e||o||["*确定"]},n)};return i.info=n,i.install=function(t,e){return function(e){q||(q=!0,H=e,Object.defineProperties(e.prototype,{$dialog:{value:t,enumerable:!0,writable:!0},$alert:{value:t.alert,enumerable:!0,writable:!0},$confirm:{value:t.confirm,enumerable:!0,writable:!0},$toast:{value:function(){for(var e=[],i=arguments.length;i--;)e[i]=arguments[i];return t.toast.apply(t,e)},enumerable:!0,writable:!0},$error:{value:t.error,enumerable:!0,writable:!0}}))}}(i),t.use(i),i.conf=Z,i.closeAll=i.destroyAll=R,i}(t.extend({props:{width:{default:"22.91rem"}},watch:{titleData:function(){u&&W.call(this)},contentData:function(){u&&W.call(this)}},mounted:function(){this.__evt_focus=function(t){}.bind(this),this.__evt_blur=function(t){}.bind(this),u&&(this.$on("changeTitle",W),this.$on("changeContent",W),W.call(this))},mixins:[N]}));U.toast=function(t,e,i){return"function"==typeof e&&(i=e,e=0),U({title:null,css:"es-dialog-toast",content:t,button:[],timeout:e||2500,animate:0},i)};return function(){var t,e=function(){var t=this.$refs.dialog;if(t&&!this._isBeingDestroyed&&!this._isDestroyed&&this._isMounted){var e=document.activeElement;if(e&&/input|textarea|select/i.test(e.tagName)){var i=t.querySelectorAll("input,textarea");if(i&&i.length){for(var n=!1,o=i.length,s=0;s<o;s++)if(i[s]===e){n=!0;break}n&&function(t){var e=Math.max(document.body.scrollTop,document.documentElement.scrollTop),i=window.innerHeight,n=t.getBoundingClientRect(),o="fixed"===this.dialogPos,s=o?n.bottom:n.bottom+e;if(n.top<0||s>i||s<0)if(o||u){var r=this.$refs.dialog,a=+(window.getComputedStyle(t).top||"").replace("px","")||0;a=n.top<0?a+Math.abs(n.top)-t.offsetTop:-(a+s-i)-t.offsetTop,r.style.top=a+"px"}else t.scrollIntoView()}.call(this,e)}}}};window.addEventListener("resize",function(){t&&window.clearTimeout(t),t=window.setTimeout(function(){_.getAllInstance().forEach(function(t){t.setPosition(!0),e.call(t)})},200)})}(),U});
